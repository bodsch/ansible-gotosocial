---

gotosocial_main_version: "{{ gotosocial_version[0:3] }}"

gotosocial_install_path: /usr/local/bin/gotosocial/{{ gotosocial_version }}

gotosocial_delegate_to: localhost

gotosocial_local_tmp_directory: "{{
  lookup('env', 'CUSTOM_LOCAL_TMP_DIRECTORY') |
  default(lookup('env', 'HOME') ~ '/.cache/ansible/gotosocial', true) }}/{{ gotosocial_version }}"

gotosocial_requirements:
  - iproute2
  - gzip

# ----------------------------------------------------------------------------------------

gotosocial_defaults_service: {}

gotosocial_defaults_config:
  general:
    log_level: "info"

    # Bool. Log database queries when log-level is set to debug or trace.
    # This setting produces verbose logs, so it's better to only enable it
    # when you're trying to track an issue down.
    # Options: [true, false]
    # Default: false
    log_db_queries: false
    # String. Application name to use internally.
    # Examples: ["My Application","gotosocial"]
    # Default: "gotosocial"
    application_name: "gotosocial"

    # String. The user that will be shown instead of the landing page. if no user is set, the landing page will be shown.
    # Examples: "admin"
    # Default: ""
    landing_page_user: ""

    # String. Hostname that this server will be reachable at. Defaults to localhost for local testing,
    # but you should *definitely* change this when running for real, or your server won't work at all.
    # DO NOT change this after your server has already run once, or you will break things!
    # Examples: ["gts.example.org","some.server.com"]
    # Default: "localhost"
    host: "localhost"
    # String. Domain to use when federating profiles. This is useful when you want your server to be at
    # eg., "gts.example.org", but you want the domain on accounts to be "example.org" because it looks better
    # or is just shorter/easier to remember.
    #
    # To make this setting work properly, you need to redirect requests at "example.org/.well-known/webfinger"
    # to "gts.example.org/.well-known/webfinger" so that GtS can handle them properly.
    #
    # You should also redirect requests at "example.org/.well-known/nodeinfo" in the same way.
    # An empty string (ie., not set) means that the same value as 'host' will be used.
    #
    # DO NOT change this after your server has already run once, or you will break things!
    #
    # Please read the appropriate section of the installation guide before you go messing around with this setting:
    # https://docs.gotosocial.org/installation_guide/advanced/#can-i-host-my-instance-at-fediexampleorg-but-have-just-exampleorg-in-my-username
    #
    # Examples: ["example.org","server.com"]
    # Default: ""
    account_domain: ""

  database:
    # String. Database type.
    # Options: ["postgres","sqlite"]
    # Default: "postgres"
    type: "sqlite"

    # String. Database address or parameters.
    #
    # For Postgres, this should be the address or socket at which the database can be reached.
    #
    # For Sqlite, this should be the path to your sqlite database file. Eg., /opt/gotosocial/sqlite.db.
    # If the file doesn't exist at the specified path, it will be created.
    # If just a filename is provided (no directory) then the database will be created in the same directory
    # as the GoToSocial binary.
    # If address is set to :memory: then an in-memory database will be used (no file).
    # WARNING: :memory: should NOT BE USED except for testing purposes.
    #
    # Examples: ["localhost","my.db.host","127.0.0.1","192.111.39.110",":memory:", "sqlite.db"]
    # Default: ""
    address: "{{ gotosocial_data_dir }}/gotosocial.db"

  web:
    # Config pertaining to templating and serving of web pages/email notifications and the like

    # String. Directory from which gotosocial will attempt to load html templates (.tmpl files).
    # Examples: ["/some/absolute/path/", "./relative/path/", "../../some/weird/path/"]
    # Default: "./web/template/"
    template_base_dir: "./web/template/"

    # String. Directory from which gotosocial will attempt to serve static web assets (images, scripts).
    # Examples: ["/some/absolute/path/", "./relative/path/", "../../some/weird/path/"]
    # Default: "./web/assets/"
    asset_base_dir: "./web/assets/"

  instance:
  accounts:
  media:
  storage:
    backend: "local"

    # String. Directory to use as a base path for storing files.
    # Make sure whatever user/group gotosocial is running as has permission to access
    # this directory, and create new subdirectories and files within it.
    # Only required when running with the local storage backend.
    # Examples: ["/home/gotosocial/storage", "/opt/gotosocial/datastorage"]
    # Default: "/gotosocial/storage"
    local_base_path: "{{ gotosocial_data_dir }}/storage"

  statuses:
  letsencrypt:
    enabled: false
  oidc:
  smtp:
  syslog:
  advanced:



# ----------------------------------------------------------------------------------------

gotosocial_defaults_directory: /etc/default

# https://github.com/superseriousbusiness/gotosocial/releases/download/v0.6.0/gotosocial_0.6.0_linux_amd64.tar.gz
# https://github.com/superseriousbusiness/gotosocial/releases/download/v0.6.0/checksums.txt

__gotosocial_files:
  archive: "gotosocial_{{ gotosocial_version }}_linux_{{ system_architecture }}.tar.gz"
  assets: "gotosocial_{{ gotosocial_version }}_web-assets.tar.gz"
  checksum: "checksums.txt"
  binary: "gotosocial_{{ gotosocial_version }}_linux_{{ system_architecture }}.tar.gz"

go_arch_map:
  x86_64: 'amd64'
  aarch64: 'arm64'
  armv7l: 'armv7'
  armv6l: 'armv6'

system_architecture: "{{ go_arch_map[ansible_architecture] | default(ansible_architecture) }}"

systemd_lib_directory: /lib/systemd/system

...
